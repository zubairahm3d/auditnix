import subprocess
import re

def scan_for_malware():
    print("\nScanning for malware...")
    malware_scan = subprocess.run(['clamscan', '-r', '--bell', '/'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    if malware_scan.returncode == 0:
        print("No malware detected.")
    elif malware_scan.returncode == 1:
        print("Malware found and removed.")
        print(malware_scan.stdout.decode())
    else:
        print("Error occurred during malware scanning.")
        print(malware_scan.stderr.decode())

def detect_intrusion():
    print("\nChecking system logs for signs of intrusion...")
    auth_log = subprocess.run(['cat', '/var/log/auth.log'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    if auth_log.returncode == 0:
        pattern = re.compile(r'(Failed|Invalid) password|authentication failure', re.IGNORECASE)
        matches = pattern.findall(auth_log.stdout.decode())
        if matches:
            print("Potential signs of intrusion found in auth logs:")
            for match in matches:
                print(match)
        else:
            print("No signs of intrusion found in auth logs.")
    else:
        print("Error occurred while checking system logs.")

def setup_alerts():
    print("\nSetting up alerts for suspicious activity...")


def audit():
    scan_for_malware()
    detect_intrusion()
    setup_alerts()
